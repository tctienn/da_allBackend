package grapservice.com.grapservice.service;

import java.sql.Date;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.web.multipart.MultipartFile;

import ch.qos.logback.core.status.Status;
import grapservice.com.grapservice.entity.GrapUserEntity;
import grapservice.com.grapservice.repository.GrapUserRepository;
import grapservice.com.grapservice.repository.http_product_Service.UploadImageService;

@Service
public class GrapUserService {

	@Autowired
	private GrapUserRepository grapUserRepository;
	
	@Autowired
	private UploadImageService uploadImageService;
	
	public String CreateUser(String name, String sdt,String address,String gender,Date birth , String scccd ,String password , MultipartFile imageCCCD, MultipartFile imageFace) {

		GrapUserEntity grapUserEntity = new GrapUserEntity();
		
		grapUserEntity.setName(name);
		grapUserEntity.setSdt(sdt);
		grapUserEntity.setAddress(address);
		grapUserEntity.setGender(gender);
		grapUserEntity.setBirth(birth);
		grapUserEntity.setScccd(scccd);
		grapUserEntity.setPassword(password);
		String urlImageCCCD = "null";
		String urlImageFace = "null";
		try {
			urlImageCCCD = uploadImageService.uploadImage(imageCCCD.getBytes());
			urlImageFace = uploadImageService.uploadImage(imageFace.getBytes());
		} catch (Exception e) {
			System.out.println("up load ảnh cccd hoặc face có vấn đề");
		}
		grapUserEntity.setImageCCCCD(urlImageCCCD);
		grapUserEntity.setImageFace(urlImageFace);
		grapUserEntity.setStatus("wait");
		
		grapUserRepository.save(grapUserEntity);
		try {
			
		} catch (Exception e) {
			System.out.println("gửi gmail xác nhận tạo tài khoản nhân viên có vấn đề");
		}
				
				
		return "tạo tài khoản thành công";
		
	}
	
	
	
}
